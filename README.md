<img src= "https://github.com/Little-tale/ShopY/assets/116441522/e4d92cdd-f0be-4bad-bbc0-b23c366827dc" width = "100" height = "100" />

# ğŸ“·Â ShopY í”„ë¡œì íŠ¸ ì†Œê°œ

<picture>
    <img src = "https://github.com/Little-tale/ShopY/assets/116441522/d1df7884-df39-488a-b73f-2c6b5c47c87b">
</picture>

## ShopY appì€ Swift UI ê¸°ë°˜ mini Shopping APP ì…ë‹ˆë‹¤.

- ShopY Appì€ Naver Shopping Rest - ful Api ë¥¼ í†µí•´ ì‡¼í•‘ì„ ì œê³µí•©ë‹ˆë‹¤.
- í˜„ì¬ ì¸ê¸° ìˆëŠ” ìƒí’ˆ ìˆœìœ„ë¥¼ ë³¼ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìƒí’ˆì„ ì§ì ‘ ê²€ìƒ‰í•˜ì—¬ ì°¾ì„ìˆ˜ ìˆìŠµë‹ˆë‹¤. (í˜ì´ì§€ ë„¤ì´ì…˜ ê¸°ëŠ¥)
- ê° ìƒí’ˆì— ì¢‹ì•„ìš”ë¥¼ ë‚¨ê¸¸ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì¢‹ì•„ìš”ë¥¼ ëª¨ì•„ì„œ í•œë²ˆì— ë³¼ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ì—¬, ì‚¬ìš©ìì—ê²Œ ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.
- ìµœì†Œ ë²„ì „ - iOS 15

## ğŸ“¸Â ê°œë°œê¸°ê°„

> 5/10 ~ 5/30 ( ëŒ€ëµ 3ì£¼ )

# ğŸ“·Â ì‚¬ìš©í•œ ê¸°ìˆ ë“¤

- SwiftUI / Combine
- MVI / Router / SingleTone /
- Realm ( Swift )
- URLSession / Kingfisher / Codable / SwiftConcurrency
- ë‹¤í¬ëª¨ë“œ ëŒ€ì‘ Asset

# UI

|                                                             ë©”ì¸ í™”ë©´                                                             |                                                               ê²€ìƒ‰                                                                |                                                             ì„¸ë¶€ í™”ë©´                                                             |
| :-------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------: |
| <img src= "https://github.com/Little-tale/ShopY/assets/116441522/c19e908b-de4e-4290-9b82-cc6640619a5e" width="190" height="400"/> | <img src= "https://github.com/Little-tale/ShopY/assets/116441522/bd7a9bf3-0320-44a3-9cee-663b6b283c71" width="190" height="400"/> | <img src= "https://github.com/Little-tale/ShopY/assets/116441522/58f69f21-d582-4945-9aa9-5eea290b9300" width="190" height="400"/> |

|                                                             ê²€ìƒ‰ ì •ë ¬                                                              |                                                              ì¢‹ì•„ìš”                                                               |                                                          ì¢‹ì•„ìš” ëª¨ì•„ë³´ê¸°                                                          |
| :--------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------: |
| <img src = "https://github.com/Little-tale/ShopY/assets/116441522/4aa319fb-ebac-40da-b44f-9f06a3b3211c" width="190" height="400"/> | <img src= "https://github.com/Little-tale/ShopY/assets/116441522/49b1769b-a47e-4cd8-a9b9-62d5f7a90f6f" width="190" height="400"/> | <img src= "https://github.com/Little-tale/ShopY/assets/116441522/ab2750dc-8f2a-45c8-a5ec-2d9d65b34f09" width="190" height="400"/> |

|                                                                ë“±ë¡                                                                |                                                         ë©”ì¸ í˜ì´ì§€ ì „í™˜                                                          |
| :--------------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------: |
| <img src = "https://github.com/Little-tale/ShopY/assets/116441522/88d07bf7-5101-4943-b72e-3f3ac32db7aa" width="190" height="400"/> | <img src= "https://github.com/Little-tale/ShopY/assets/116441522/e15fa76f-5bc4-4471-8ffd-d92fac78304e" width="190" height="400"/> |

# ğŸ“·Â ê¸°ìˆ ì„¤ëª…

## MVI + Combine

> Swift UI ëŠ” UIKit ê³¼ëŠ” ë‹¤ë¥´ê²Œ ìì²´ì ìœ¼ë¡œ ë°˜ì‘í˜•ì„ ì§€ì›í•˜ê³  ìˆìœ¼ë©°,
> ì–‘ë°©í–¥ì˜ íë¦„ì´ ë ìˆ˜ ìˆëŠ” MVVM ë³´ë‹¨ ì‚¬ìš©ìì˜ ì…ë ¥ì„ ì‹œì‘ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ê±°ì¹œí›„,
> Viewì˜ ìƒíƒœ ë°˜ì˜ í•˜ëŠ” ë‹¨ë°©í–¥ íë¦„ì¸ MVI ë¥¼ í†µí•´ í”„ë¡œì íŠ¸ë¥¼ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
import Combine

protocol MVIPatternType: ObservableObject {

    associatedtype Intent

    associatedtype StateModel

    var stateModel: StateModel { get }

    func send(_ action: Intent)
}
```
### íšŒê³ ì •ë¦¬ : Swift UI + MVVM ê³¼ì—° ë§ì„ê¹Œ? https://velog.io/@little_tail/9ps8g62w
---

## DTO - Entity

> APIë¥¼ í†µí•´ ë°›ì•„ì˜¤ëŠ” ë°ì´í„°ì™€ ë·°ê°€ ì‚¬ìš©í•  ëª¨ë¸ì„ ë¶„ë¦¬ í•˜ì—¬
> í›„ì— API ì‘ë‹µê°’ì´ ë°”ë€Œê±°ë‚˜, ë˜ëŠ” ë·°ê°€ ì‚¬ìš©í•  ë‚´ìš©ì´ ë°”ë€” ê²ƒì„ ë¹ ë¥´ê²Œ ëŒ€ì²˜í•˜ê¸° ìœ„í•´
> êµ¬ì„± í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
final class ShopItemsRepository {

    private
    let shopMapper = ShopEntityMapper()

    private
    let repository = RealmRepository()

}
////
struct ShopEntityMapper {

    // API ë¥¼ í†µí•œ ëª¨ë¸
    func toEntity(_ dto: ShopItemDTOModel) -> ShopEntityModel?

    // Realm ëª¨ë¸ì˜ ëŒ€í•œ
    func toEntity(_ likeModel: LikePostModel) -> ShopEntityModel
}

```

### íšŒê³ ì •ë¦¬ : https://velog.io/@little_tail/DTO

---

## ViewModifier + Button

> Button ê³¼ ViewModifer ë¥¼ ì´ìš©í•˜ì—¬ ë²„íŠ¼ì„

```swift
extension View {
    func asButton(action: @escaping () -> Void ) -> some View {
        modifier(ButtonWrapper(action: action))
    }
}

struct ButtonWrapper: ViewModifier {

    let action: () -> Void

    func body(content: Content) -> some View {
        Button(
            action:action,
            label: { content }
        )
    }
}
```

# ğŸ“·Â í”„ë¡œì íŠ¸ ì¤‘ ìƒˆë¡­ê²Œ ë°°ìš´ ê²ƒë“¤

## Swift Concurrency

> WWDC 2021 ì— ë°œí‘œí•œ Swift Concurrencyì— ëŒ€í•´ì„œ í•™ìŠµí•˜ê³ ,
> ì´ì „ì—ëŠ” Completion Handler ë¥¼ í†µí•´ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì»¨íŠ¸ë¡¤ í•˜ì˜€ìœ¼ë‚˜,
> Swift Concurrencyë¥¼ í™œìš©í•˜ì—¬ ë¹„ë™ê¸° ì½”ë“œë¥¼ ë™ê¸° ì½”ë“œì²˜ëŸ¼ ë³´ì—¬ì§ˆìˆ˜ ìˆê²Œ,
> ì½”ë“œê°€ ë” ê°€ë…ì„± ì¢‹ì„ìˆ˜ ìˆë„ë¡ êµ¬ì„± í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
import Foundation
import Combine

protocol NetworkManagerType {

    typealias FetchType<T: Decodable> = AnyPublisher<T,NetworkError>

    static func fetchNetwork<T:Decodable>(model: T.Type, router: NaverRouter) -> FetchType<T>

    static func checkReqeust<T: Decodable>(type: T.Type, router: NaverRouter) async throws -> T

    static func checkURLRequest(router: NaverRouter) throws -> URLRequest

    static func checkURLResponse(response: URLResponse) throws

    static func decode<T: Decodable>(data: Data) throws -> T
}

struct NetworkManager: NetworkManagerType { }

extension NetworkManager {

    static func fetchNetwork<T:Decodable>(model: T.Type, router: NaverRouter) -> FetchType<T> {

        Future <T, NetworkError> { promiss in
            Task {
                do {
                    let result = try await checkReqeust(type: model, router: router)
                    promiss(.success(result))
                } catch let error as NetworkError {
                    promiss(.failure(error))
                } catch {
                    promiss(.failure(.unknownError))
                }
            }
        }
        .eraseToAnyPublisher()
    }
}
```

### íšŒê³ ì •ë¦¬ : [https://velog.io/@little_tail/SwiftConcurrency 1í¸](https://velog.io/@little_tail/View-On-Appear-%EB%8A%94-ViewDidAppear%EB%9E%91-%EA%B0%99%EC%9D%84%EA%B9%8C-Swift-UI)

---

## HTML íƒœê·¸ ì œê±°

> Naver ê²€ìƒ‰ Rest API - ful ë¥¼ í†µí•´ ìƒí’ˆëª…ì„ ë°›ì•„ì˜¤ë©´ <b> (ë³¼ë“œ íƒœê·¸) ê°€ ë°›ì•„ì™€ ì§€ëŠ” ì´ìŠˆê°€ ìˆì—ˆìŠµë‹ˆë‹¤.
> ì²˜ìŒì—ëŠ” ì§ì ‘ bold íƒœê·¸ë¥¼ ì œê±° í•˜ì˜€ì—ˆìœ¼ë‚˜ í›„ì— ë„¤ì´ë²„ API ì—ì„œ ë³¼ë“œ íƒœê·¸ê°€ ì•„ë‹Œ ë‹¤ë¥¸ íƒœê·¸ë¡œ ê²°ê³¼ ê°’ì„
> ì¤„ê²ƒì„ ëŒ€ë¹„í•˜ì—¬ `NSAttributedString.DocumentReadingOptionKey` ì˜ ì˜µì…˜ì¤‘ HTML ë¬¸ì„œ í˜•ì‹ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ íƒœê·¸ë¥¼ ì œê±°í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
// Before
var rmHTMLBold: String {

     let first = self.replacingOccurrences(of: "<b>", with: "")

     let results = first.replacingOccurrences(of: "</b>", with: "")

     return results

 }
// After
extension String {

    typealias ReadingOption = NSAttributedString.DocumentReadingOptionKey
    typealias DocumentType = NSAttributedString.DocumentType

    var rmHTMLTag: String {
        guard let data = self.data(using: .utf8) else { return self }

        let options: [ReadingOption : Any] = [
            .documentType: DocumentType.html,
            .characterEncoding: String.Encoding.utf8.rawValue
        ]

        do {
            let attrubuted = try NSAttributedString(
                data: data,
                options: options,
                documentAttributes: nil)

            return attrubuted.string
        } catch {
            return self
        }
    }

}

```

---

## propertyWrapper

> ê°„ë‹¨í•œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ ìš©í•œ UserDefaults ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•œ ì½”ë“œì¤‘ ì¤‘ë³µë˜ëŠ” ì½”ë“œë“¤ì´ ë§ì•„
> Swift 5.1 ì—ì„œ ì¶”ê°€ëœ propertyWrapper ë¥¼ í•™ìŠµí•˜ê³ , UserDefaults ì— ì ìš©í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.

```swift
@propertyWrapper
struct UserDefaultWrapper<T> {
    let key: String
    let placeValue: T

    let ofCase: UserDefaultCase

    private let US = UserDefaults.standard

    var wrappedValue: T

}

// UserDefaults Manager
@UserDefaultCodableWrapper(key: Key.productId.rawValue, placeValue: [])
    static var productId: Set<String>

@UserDefaultWrapper(key: Key.searchHistory.rawValue, placeValue: [], ofCase: Key.searchHistory.caseType)
    static var searchHistory: Array<String>
```

---

## Realm + **Xcode 15 + iOS 17 ì´í•˜ ë²„ì „ ì´ìŠˆ**

> iOS 17 ë²„ì „ì—ì„œëŠ” Realm ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™ í•˜ì˜€ìœ¼ë‚˜, iOS 16 ì´í•˜ ë²„ì „ìœ¼ë¡œ ì‹¤í–‰ì‹œ
> â€ Thread 1: EXC_BAD_ACCESS (code=1, address=0x0) â€œ ë¼ëŠ” ë©”ì‹œì§€ ì™€ í•¨ê»˜
> Realm ì´ ë™ì‘í•˜ì§€ ì•Šë˜ ì´ìŠˆê°€ ìˆì—ˆìŠµë‹ˆë‹¤. í•´ë‹¹í•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ê²€ìƒ‰ê³¼,
> GitHub Issue Communityì„ í™œìš©í•˜ì˜€ìœ¼ë©°, ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë ˜ì˜ ëª¨ë¸ì„ ì§ì ‘ ëª…ì‹œí•˜ëŠ” ë°©ë²•ìœ¼ë¡œ
> ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
private var realm: Realm?

    static func registerRealmClass() {
        let classes: [Object.Type] = [
            LikePostModel.self,
            ProfileRealmModel.self
        ]
        let config = Realm.Configuration(objectTypes: classes)
        Realm.Configuration.defaultConfiguration = config
    }

    init() {
        if #available(iOS 17, *) {
            // None
        } else {
            RealmRepository.registerRealmClass()
        }
        do {
            let realms = try Realm()
            realm = realms
            print(realm?.configuration.fileURL ?? "Realm MISS")
        } catch {
            print("Realm Init ë¬¸ì œ ")
            realm = nil
        }
    }
```

### Invalid frame dimension (negative or non-finite)

> Swift UI ë¥¼ ì²˜ìŒìœ¼ë¡œ ë„ì…í•˜ë©´ì„œ ê²ªì€ ë¬¸ì œë¡œ,
> .Infinity ( ë¬´í•œëŒ€ ) ë¥¼ ë§ˆì¹˜ Spacer() ì™€ ê°™ì€ ê°œë…ì´ë¼ê³  ì°©ê°ì„ í•˜ê³ 
> ì‚¬ìš©í•˜ì˜€ì—ˆëŠ”ë° í•´ë‹¹ ì˜¤ë¥˜ë¥¼ ê²ªê³  Infinity ì™€ ë ˆì´ì•„ì›ƒ ì‹œìŠ¤í…œì— ëŒ€í•´ì„œ í•™ìŠµí•˜ì˜€ìŠµë‹ˆë‹¤.
> ë¬¸ì œì˜ í•´ê²° ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ì´ ê°„ë‹¨ í•˜ì˜€ìœ¼ë‚˜ ì™œ ìŒìˆ˜ë¼ê³  í•˜ì˜€ëŠ”ì§€
> ì›ì¸ì„ ì•Œì•„ì•¼ í•œë‹¤ê³  ìƒê° í–ˆì—ˆìŠµë‹ˆë‹¤.

### íšŒê³ ì •ë¦¬ : Swift Layout System https://velog.io/@little_tail/SwiftUILayoutSysytem

```swift
// Before
.frame(width: .infinity, height: 46)
// After
.frame(maxWidth: .infinity)
.frame(height: 46)
```
